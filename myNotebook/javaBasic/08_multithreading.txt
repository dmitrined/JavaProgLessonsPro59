### Многопоточность (Multithreading)

Многопоточность позволяет выполнять несколько частей программы (потоков) параллельно, максимально используя ресурсы процессора.

#### 1. Создание потоков
В Java есть два основных способа создать поток:

1.  **Наследование от класса `Thread`:**
    ```java
    class MyThread extends Thread {
        @Override
        public void run() {
            System.out.println("Thread running");
        }
    }
    // Запуск:
    new MyThread().start();
    ```

2.  **Реализация интерфейса `Runnable` (предпочтительно):**
    Позволяет классу наследоваться от другого класса.
    ```java
    class MyRunnable implements Runnable {
        @Override
        public void run() {
            System.out.println("Runnable running");
        }
    }
    // Запуск:
    new Thread(new MyRunnable()).start();
    ```

#### 2. Жизненный цикл потока
*   **New:** Создан, но не запущен (`start()` еще не вызван).
*   **Runnable:** Готов к выполнению или выполняется.
*   **Blocked:** Ждет освобождения монитора (блокировки).
*   **Waiting / Timed Waiting:** Ждет сигнала от другого потока или истечения времени (`wait()`, `sleep()`, `join()`).
*   **Terminated:** Завершил выполнение.

#### 3. Синхронизация
Необходима для предотвращения состояния гонки (Race Condition), когда несколько потоков одновременно изменяют общие данные.

*   **synchronized метод:** Блокирует весь объект (`this`) или класс (если метод статический).
*   **synchronized блок:** Блокирует конкретный объект-монитор.
    ```java
    synchronized(lockObject) {
        // критическая секция
    }
    ```
*   **volatile:** Гарантирует видимость изменений переменной для всех потоков (чтение всегда из основной памяти, а не из кэша процессора). Не гарантирует атомарность.

#### 4. Методы класса Object для взаимодействия
*   `wait()`: поток освобождает монитор и переходит в режим ожидания.
*   `notify()`: будит один случайный поток, ждущий на этом мониторе.
*   `notifyAll()`: будит все ждущие потоки.
*   Эти методы должны вызываться только внутри `synchronized` блока.

#### 5. Concurrency Utilities (java.util.concurrent)
Более высокоуровневые инструменты для работы с потоками (Java 5+).

*   **ExecutorService:** Пул потоков. Управляет созданием и переиспользованием потоков.
    *   `Executors.newFixedThreadPool(int n)`
    *   `Executors.newCachedThreadPool()`
*   **Callable & Future:** Аналог `Runnable`, но может возвращать результат и выбрасывать исключения.
*   **Concurrent Collections:** Потокобезопасные коллекции (`ConcurrentHashMap`, `CopyOnWriteArrayList`).
*   **Atomic Variables:** Атомарные операции над примитивами (`AtomicInteger`, `AtomicBoolean`).
*   **Locks:** Более гибкие механизмы блокировок (`ReentrantLock`, `ReadWriteLock`).
